<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<project basedir="." default="build" name="wysiwyg">
    <target name="build" depends="versionhint">
        <delete dir="bin/zip" />
        <delete>
            <fileset dir="bin" includes="wysiwyg*.zip" />
        </delete>
        <mkdir dir="bin/zip" />

        <copy todir="bin/zip/extensions/WYSIWYG/">
            <fileset file="../**">
                <exclude name="**/.svn, **/CVS" />
                <exclude name="**/deploy/**" />
                <exclude name="**/tests/**" />
            </fileset>
        </copy>
        <zip destfile="bin/wysiwyg.zip" basedir="bin/zip" />
        <delete dir="bin/zip" />
        <exec executable="php">
            <arg value="../../../buildtools/renameDeployable.php" />
            <arg value="../deploy.xml" />
            <arg value="bin/wysiwyg.zip" />
        </exec>
    </target>

    <target name="versionhint">
        <property environment="env" />
        <exec executable="php">
            <arg value="../../../buildtools/replaceVersionHint.php" />
            <arg value="../deploy.xml" />
            <arg value="../WYSIWYG.php" />
            <arg value="${env.BUILD_NUMBER}" />
        </exec>
    </target>


</project>
